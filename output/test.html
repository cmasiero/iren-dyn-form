<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/example/example.css">
    <title>Titolo scheda di test!</title>
  </head>

  <body>


  </body>
  <form onsubmit="postScheda()"><input type="submit" value="Invia">
    <div class="table-title" id="id_title_00">
      Titolo 1
    </div>
    <div class="div-table" id="00">
      <div class="div-table-row" id="id_row_0">
        <div class="div-table-col" id="id_col_0_0"><strong>Descrizione text e checkbox</strong></div>
        <div class="div-table-col" id="id_col_0_1">
          <label for="00_id">descrizione text 00</label>
          <input type="text" id="00_id" value="">
        </div>
        <div class="div-table-col" id="id_col_0_2">
          <label for="01_id">descrizione text 01</label>
          <input type="text" id="01_id" value="">
        </div>
        <div class="div-table-col" id="id_col_0_3">
          <label for="02_id">descrizione text 02</label>
          <input type="text" id="02_id" value="hard_coded">
        </div>
        <div class="div-table-col" id="id_col_0_4">
          <input type="checkbox" id="03_id" name="03_id" value="" checked="">
          <label for="03_id">descrizione checkbox 03</label>
        </div>
        <div class="div-table-col" id="id_col_0_5">
          <input type="checkbox" id="03_id" name="03_id" value="">
          <label for="03_id">descrizione checkbox 02</label>

          <input type="checkbox" id="04_id" name="04_id" value="">
          <label for="04_id">descrizione checkbox 03</label>
        </div>
      </div>
      <div class="div-table-row" id="id_row_1">
        <div class="div-table-col" id="id_col_1_0"><strong>Please select your gender</strong></div>
        <div class="div-table-col" id="id_col_1_1">
          <input type="radio" id="male" name="id_gender" value="male">
          <label for="male">description male</label>
          <input type="radio" id="female" name="id_gender" value="female">
          <label for="female">description female</label>
          <input type="radio" id="other" name="id_gender" value="other">
          <label for="other">description other</label>
        </div>
      </div>
    </div>
    <div class="div-table" id="01">
      <div class="div-table-row" id="id_row_2">
        <div class="div-table-col" id="id_col_2_0"><strong>Descrizione combo box</strong></div>
        <div class="div-table-col" id="id_col_2_1">
          <label for="id_cars">Choose a car:</label>
          <select name="id_cars" id="id_cars">
            <option value=""></option>
            <option value="volvo">description volvo</option>
            <option value="saab">description saab</option>
            <option value="fiat" selected="selected">description fiat</option>
          </select>
        </div>
      </div>
    </div>
  </form>
  <script type="text/javascript">
    (function() {
      console.log("doc ready");
      visibility();
      let form = document.querySelector('form');
      form.addEventListener('change', function() {
        visibility();
      });
    })();

    function visibilityParent(element) {
      let col = element.parentNode;
      let children = col.childNodes;

      let displayCol = false;
      for (let i = 0; i < children.length; i++) {
        if (children[i].style !== undefined && children[i].style.display !== 'none') {
          displayCol = true;
          break;
        }
      }
      col.style.display = displayCol ? "inline" : "none";
    }

    function visibility() {
      console.log("[visibility]");
      if (document.getElementById('02_id').value == 'hard coded') {
        let node = document.getElementById('00_id');
        node.style.display = "inline";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "inline";
        } else {
          node.nextElementSibling.style.display = "inline";
        }
        visibilityParent(node);
      } else {
        let node = document.getElementById('00_id');
        node.style.display = "none";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "none";
        } else {
          node.nextElementSibling.style.display = "none";
        }
        visibilityParent(node);
      }
      if (document.getElementById('02_id').value == 'hard coded') {
        let node = document.getElementById('03_id');
        node.style.display = "inline";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "inline";
        } else {
          node.nextElementSibling.style.display = "inline";
        }
        visibilityParent(node);
      } else {
        let node = document.getElementById('03_id');
        node.style.display = "none";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "none";
        } else {
          node.nextElementSibling.style.display = "none";
        }
        visibilityParent(node);
      }
      if (document.getElementById('02_id').value == 'hard coded') {
        let node = document.getElementsByName('id_gender');
        node.forEach(n => {
          n.style.display = "inline";
          n.nextElementSibling.style.display = "inline";
          if (node[node.length - 1] === n) {
            visibilityParent(n);
          }
        });
      } else {
        let node = document.getElementsByName('id_gender');
        node.forEach(n => {
          n.style.display = "none";
          n.nextElementSibling.style.display = "none";
          if (node[node.length - 1] === n) {
            visibilityParent(n);
          }
        });
      }
      if (document.getElementById('02_id').value == 'hard coded') {
        let node = document.getElementById('id_cars');
        node.style.display = "inline";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "inline";
        } else {
          node.nextElementSibling.style.display = "inline";
        }
        visibilityParent(node);
      } else {
        let node = document.getElementById('id_cars');
        node.style.display = "none";
        if (node.previousElementSibling !== null) {
          node.previousElementSibling.style.display = "none";
        } else {
          node.nextElementSibling.style.display = "none";
        }
        visibilityParent(node);
      }
    }

    function validation() {
      let result = [];
      let v_02_id = document.getElementById('02_id').value;
      if (v_02_id === '') {
        result.push("Il campo descrizione text 02 Ã¨ obbligatorio!");
      }
      return result;
    }

    function postScheda() {
      let arrayMessage = validation();
      let message = ""
      arrayMessage.forEach(msg => {
        message = message.concat(msg).concat("\n");
      });
      if (message !== "") {
        alert(message);
      } else {
        alert("DEBUG: FORM VALIDO, VERRA INVIATO AL SERVER!");
      }
    }
  </script>

</html>